{"version":3,"file":"algoframe.js","mappings":"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","sources":["webpack://AlgoFrame/webpack/universalModuleDefinition","webpack://AlgoFrame/./modules/timeline/index.ts","webpack://AlgoFrame/./modules/timeline/utils.ts","webpack://AlgoFrame/./test.ts","webpack://AlgoFrame/./utils.ts","webpack://AlgoFrame/./algoframe/utils.js","webpack://AlgoFrame/./algoframe/index.js","webpack://AlgoFrame/webpack/bootstrap","webpack://AlgoFrame/webpack/runtime/define property getters","webpack://AlgoFrame/webpack/runtime/hasOwnProperty shorthand","webpack://AlgoFrame/webpack/runtime/make namespace object","webpack://AlgoFrame/webpack/startup"],"sourcesContent":["(function webpackUniversalModuleDefinition(root, factory) {\n\tif(typeof exports === 'object' && typeof module === 'object')\n\t\tmodule.exports = factory();\n\telse if(typeof define === 'function' && define.amd)\n\t\tdefine([], factory);\n\telse if(typeof exports === 'object')\n\t\texports[\"AlgoFrame\"] = factory();\n\telse\n\t\troot[\"AlgoFrame\"] = factory();\n})(self, () => {\nreturn ","import { Preset, passPreset } from '../../utils';\r\nimport {\r\n  _keyframe,\r\n  IObjectKeyframe,\r\n  nestedKeyframe,\r\n  valueKeyframe,\r\n  __objectKeyframe,\r\n  __valueKeyframe,\r\n  ISimpleKeyframe,\r\n  isComplex,\r\n  isSimple,\r\n  timeIntervals,\r\n  replicate,\r\n  IBaseKeyframe,\r\n  // BaseKeyframe,\r\n} from './utils';\r\nexport * from './utils';\r\n// Classes\r\n\r\nexport abstract class KeyChanger<Keyframe extends _keyframe> {\r\n  public duration: number;\r\n  run: Keyframe[];\r\n  next: Keyframe | null = null;\r\n  current: Keyframe | null = null;\r\n  public adaptative: boolean = false;\r\n  easing: (t: number) => number;\r\n\r\n  constructor(\r\n    duration: number | false,\r\n    easing: Preset = 'linear',\r\n    public keyframes: Keyframe[]\r\n  ) {\r\n    this.duration =\r\n      typeof duration === 'number'\r\n        ? Math.floor(duration)\r\n        : (_ => {\r\n            this.adaptative = true;\r\n            return 1;\r\n          })();\r\n    this.run = [];\r\n    this.easing = passPreset(easing);\r\n    this.init(keyframes);\r\n  }\r\n  protected nextTime(): void {\r\n    if (!this.run.length) {\r\n      this.next = null;\r\n      return;\r\n    }\r\n    if (this.run.length > 1) {\r\n      this.current = this.run.reduce((previousValue, currentValue) => {\r\n        return currentValue!.time(this.duration) <\r\n          previousValue!.time(this.duration)\r\n          ? currentValue\r\n          : previousValue;\r\n      });\r\n      this.next =\r\n        this.run\r\n          .filter(\r\n            v => v!.time(this.duration) !== this.current!.time(this.duration)\r\n          )\r\n          .reduce((previousValue, currentValue) =>\r\n            currentValue!.time(this.duration) <\r\n            previousValue!.time(this.duration)\r\n              ? currentValue\r\n              : previousValue\r\n          ) || this.current;\r\n      // console.log(this.current?.time(1), this.next.time(1), this.run);\r\n    } else {\r\n      this.reset();\r\n    }\r\n    this.run.shift();\r\n  }\r\n  public abstract reset(): void;\r\n  protected abstract init(keyframes: Keyframe[]): void;\r\n  // This is called when in this.test(), this.current is of type nestedKeyframe, so treat de return as a nested timeline call.\r\n  protected currentAsSequence(\r\n    object: IObjectKeyframe,\r\n    progress: number,\r\n    end: number\r\n  ): number | undefined {\r\n    // console.log((progress - object.time(1)) / (end - object.time(1)));\r\n    const rProgress = (progress - object.time(1)) / (end - object.time(1));\r\n    let res!: number;\r\n    if (rProgress <= 1) {\r\n      // console.log(object.obj);\r\n      res = object.obj.test(rProgress, undefined, true) as number;\r\n      return res;\r\n    }\r\n  }\r\n  static lerp(x: number, y: number, a: number) {\r\n    const lerp = x * (1 - a) + y * a;\r\n    return lerp;\r\n  }\r\n  public test(\r\n    progress: number,\r\n    miliseconds: boolean = false,\r\n    runAdaptative: boolean = false,\r\n    nextValue?: ISimpleKeyframe\r\n  ): number | undefined {\r\n    progress = progress <= 1 ? progress : 1;\r\n    let next = nextValue ? nextValue : this.next;\r\n    if (this.adaptative && !runAdaptative) {\r\n      throw new Error(\r\n        'Adaptitive timed sequences cannot be played in first place'\r\n      );\r\n    }\r\n    if (miliseconds && !runAdaptative) progress = progress * this.duration;\r\n    else if (miliseconds)\r\n      throw new Error('miliseconds mode not allowe when adaptative');\r\n    if (next && this.current) {\r\n      while (next!.time(1) <= progress && !(next!.time(1) === 1)) {\r\n        this.nextTime(); //bug-proof\r\n        next = this.next;\r\n      }\r\n      if (isSimple(next) && isSimple(this.current)) {\r\n        progress = Math.min(\r\n          this.easing(progress),\r\n          miliseconds ? this.duration : 1\r\n        );\r\n        const a = next.time(1) - this.current.time(1);\r\n        const trace = progress / a;\r\n        const kProgress =\r\n          progress < progress - a\r\n            ? trace\r\n            : (progress - this.current.time(1)) / a;\r\n        // console.log(String([this.current.time(1), next.time(1)]));\r\n        const lerp = KeyChanger.lerp(\r\n          this.current.value,\r\n          next.value,\r\n          next.hold ? 0 : kProgress\r\n        );\r\n        // debugger;\r\n        // console.log(this.current, next);\r\n        return lerp;\r\n      } else if (isComplex(next) && isSimple(this.current)) {\r\n        // return (this.current as nestedKeyframe).obj.test(progress - this.current.time);\r\n        const nextValueFromObj = new valueKeyframe(\r\n          this.getAbsoluteStartValue(next.obj as Sequence),\r\n          next.time(1),\r\n          'ratio'\r\n        );\r\n        nextValueFromObj.duration = this.duration;\r\n        return this.test(\r\n          progress,\r\n          undefined,\r\n          undefined,\r\n          nextValueFromObj\r\n          // this.next.obj.run[0].value\r\n        );\r\n      } else if (isComplex(this.current) && isComplex(next)) {\r\n        // this.nextTime();\r\n        // debugger;\r\n        const res = this.currentAsSequence(\r\n          this.current,\r\n          progress,\r\n          this.next ? this.next.time(1) : 1\r\n        );\r\n        return res;\r\n      } else if (isComplex(this.current) && (isSimple(next) || !next)) {\r\n        // console.log(progress.toFixed(2));\r\n        return this.currentAsSequence(\r\n          this.current,\r\n          progress,\r\n          next ? next.time(1) : 1\r\n        );\r\n      }\r\n    }\r\n  }\r\n  getAbsoluteStartValue(sequence: Sequence): number {\r\n    let last = sequence.current;\r\n    while (last instanceof nestedKeyframe) {\r\n      last = sequence.current;\r\n    }\r\n    return last!.value;\r\n  }\r\n  getAbsoluteEndKeyframe(sequence: Sequence): valueKeyframe {\r\n    let last = sequence.run[sequence.run.length - 1];\r\n    while (last instanceof nestedKeyframe) {\r\n      last = sequence.run[sequence.run.length - 1];\r\n    }\r\n    return last;\r\n  }\r\n}\r\n\r\n// TODO:\r\n// 1. Nested Sequence instances DONE\r\n//    Adaptative Sequence duration DONE\r\n// P.D.: That's not the as AlgoFrame.timeline, which each timing 'sequence' has its own function rather a numeric value in a Sequence\r\n\r\nexport type normalKeyframes = valueKeyframe | nestedKeyframe;\r\nexport class Sequence extends KeyChanger<normalKeyframes> {\r\n  type: 'nested' | 'simple' = 'simple';\r\n  taken: number[] = [];\r\n  constructor(\r\n    duration: number | false,\r\n    public keyframes: (valueKeyframe | nestedKeyframe)[],\r\n    easing: Preset = 'linear',\r\n    public callback: Function | null = null\r\n  ) {\r\n    super(duration, easing, keyframes);\r\n    // Pushes and Checks if all events are of type nestedKeyframe or _keyframe\r\n  }\r\n  protected init(keyframes: typeof this.keyframes) {\r\n    if (window['debug']) debugger;\r\n    this.type = 'simple';\r\n    keyframes.forEach(k => {\r\n      if (k.type == 'ratio') {\r\n        k.timing = k.timing * this.duration;\r\n        k.type = 'miliseconds';\r\n      }\r\n    });\r\n    this.taken = [];\r\n    const zero = keyframes[0];\r\n    const final = keyframes[keyframes.length - 1];\r\n    zero.duration = this.duration;\r\n    final.duration = this.duration;\r\n    if (zero.time(1) > 0) {\r\n      // this.taken.push(0);\r\n      const first =\r\n        zero instanceof valueKeyframe\r\n          ? new valueKeyframe(zero.value, 0)\r\n          : new nestedKeyframe(zero.obj, 0);\r\n      first.duration = this.duration;\r\n      this.keyframes.unshift(first);\r\n      this.run.push(first);\r\n    }\r\n    if (final.time(1) < 1) {\r\n      if (final instanceof nestedKeyframe)\r\n        throw new Error(\r\n          \"Cannot set last keyframe as nested sequence, it's impossible\"\r\n        );\r\n      const last = new valueKeyframe(final.value, 1, 'ratio');\r\n      last.duration = this.duration;\r\n      this.keyframes.push(last);\r\n      this.run.push(last);\r\n    }\r\n\r\n    this.keyframes.forEach((k: any, i) => {\r\n      k.duration = this.duration;\r\n      k = k;\r\n      const timing = k.time(this.duration);\r\n      if (timing > this.duration) throw new Error('Keyframe timing overflow');\r\n      if (this.taken.includes(timing))\r\n        throw new Error('It must not have repeated times');\r\n      this.taken.push(k.time(1));\r\n      if (k instanceof nestedKeyframe) this.type = 'nested';\r\n      this.run.push(k);\r\n    });\r\n    if (!this.type) throw new Error('No events/keyframes provided');\r\n\r\n    if (this.keyframes[0] instanceof valueKeyframe) {\r\n    }\r\n    try {\r\n      this.nextTime();\r\n    } catch {\r\n      throw new Error(\r\n        'Identical time signatures on keyframes are not allowed on a single animation channel'\r\n      );\r\n    }\r\n  }\r\n  static passKeyframe(k: any | nestedKeyframe | valueKeyframe) {\r\n    if (k instanceof nestedKeyframe || k instanceof valueKeyframe) return k;\r\n    return this.is_value(k)\r\n      ? new valueKeyframe(k.value, k.timing, k.type)\r\n      : new nestedKeyframe(k.obj, k.timing, k.type);\r\n  }\r\n  static is_value(object: any): object is __valueKeyframe {\r\n    return 'val' in object;\r\n  }\r\n  public addKeyframes(\r\n    /**\r\n     * Adds a new keyframe to the entire set,\r\n     *\r\n     * @remarks\r\n     * To apply new keyframes, must do .reset() before\r\n     *\r\n     * @param keyframe - A valid AlgoFrame's keyframe object\r\n     */\r\n    ...keyframes: normalKeyframes[]\r\n  ): Sequence {\r\n    keyframes.forEach(keyframe => {\r\n      const nkeyframe = Sequence.passKeyframe(keyframe);\r\n      this.keyframes.push(nkeyframe);\r\n    });\r\n    const { max: duration } = timeIntervals(this.keyframes);\r\n    this.keyframes.forEach(k => {\r\n      if (k.type == 'ratio') {\r\n        k.timing = k.timing * duration;\r\n        k.type = 'miliseconds';\r\n      }\r\n    });\r\n    this.duration = duration;\r\n    this.init(this.keyframes);\r\n    return this;\r\n  }\r\n  public extendToSequence(seq: Sequence) {\r\n    seq.keyframes.forEach(k => {\r\n      k.timing =\r\n        k.timing +\r\n        (k.duration + this.duration) *\r\n          (k.duration / (this.duration + k.duration));\r\n      k.duration += this.duration;\r\n    });\r\n    this.keyframes.forEach(k => {\r\n      k.timing =\r\n        k.timing +\r\n        (k.duration + this.duration) *\r\n          (k.duration / (this.duration + k.duration));\r\n      k.duration += this.duration;\r\n    });\r\n    this.keyframes.forEach(k => {\r\n      console.log(k.duration);\r\n    });\r\n    console.log(seq.keyframes.map(k => [k.time(1), k.duration]));\r\n    this.addKeyframes(...seq.keyframes);\r\n    return this;\r\n  }\r\n  public reset(): void {\r\n    this.keyframes.forEach(k => this.run.push(k));\r\n  }\r\n  public clone(): Sequence {\r\n    const keyframes = this.keyframes.map(k => {\r\n      if (isComplex(k)) {\r\n        const copy = replicate(\r\n          k\r\n        ) as Keyframe as IObjectKeyframe as nestedKeyframe;\r\n        copy.obj = copy.obj.clone();\r\n        return copy;\r\n      }\r\n      return replicate(k) as Keyframe;\r\n    });\r\n    let copy: Sequence = new Sequence(\r\n      this.duration,\r\n      keyframes as any,\r\n      this.easing,\r\n      this.callback\r\n    );\r\n\r\n    return copy;\r\n  }\r\n  // public reset(): void in abstract parent class\r\n}\r\n","import { KeyChanger, Sequence } from '.';\r\n\r\nexport function timeIntervals(blocks: _keyframe[]) {\r\n  let max = 1;\r\n  let min = 0;\r\n  const intervals = blocks.map((block, i) => {\r\n    let kDuration = 0;\r\n    function tstart(block: _keyframe) {\r\n      return block.start ? block.start : 0 + block.time();\r\n    }\r\n    const time = tstart(block);\r\n    if (i < blocks.length - 1) {\r\n      kDuration = tstart(blocks[i + 1]) - time - 1;\r\n      if (kDuration < block.delay) {\r\n        throw new Error(\r\n          'Sequences/_keyframe(s) overlapping on the same channel!'\r\n        );\r\n      }\r\n    }\r\n    const end = block.start ? block.start : 0 + time + kDuration;\r\n    max = max < end ? end : max;\r\n    min = min > time ? time : min;\r\n    return [time, end];\r\n  });\r\n  return { max, min };\r\n}\r\nexport function replicate(obj: object): object {\r\n  return Object.assign(Object.create(Object.getPrototypeOf(obj)), obj);\r\n}\r\nexport function ratioAndMilisecons(\r\n  ratio: number,\r\n  miliseconds: number,\r\n  duration: number\r\n): number {\r\n  /**\r\n   * @param ratio - The ratio of the basic measure, between 0 and 1\r\n   * @param miliseconds - Miliseconds to delay on the ratio\r\n   * @param duration - Total duration of the sequence\r\n   * @returns The arithmetic sum with all parameters in miliseconds\r\n   */\r\n  return ratio * duration + miliseconds;\r\n}\r\nexport interface IBaseKeyframe {\r\n  time(duration: number): number;\r\n}\r\n\r\nexport interface IObjectKeyframe extends IBaseKeyframe {\r\n  [x: string]: any;\r\n  obj: KeyChanger<any>;\r\n}\r\nexport interface ISimpleKeyframe extends IBaseKeyframe {\r\n  [x: string]: any;\r\n  value: number;\r\n}\r\n\r\nexport class _keyframe implements IBaseKeyframe {\r\n  static instances = 0;\r\n  readonly id: number;\r\n  public duration!: number;\r\n  constructor(\r\n    public timing: number,\r\n    public type: 'ratio' | 'miliseconds' = 'ratio',\r\n    public delay: number = 0,\r\n    public hold: boolean = false,\r\n    public start: number = 0\r\n  ) {\r\n    if (start < 0) {\r\n      throw new RangeError('Negative start times are not implemented yet');\r\n    }\r\n    this.id = _keyframe.instances++;\r\n    if (this.type === 'miliseconds') {\r\n      this.duration = 0;\r\n    }\r\n  }\r\n  public time(duration: number = this.duration): number {\r\n    let timing = this.timing;\r\n    if (this.delay) {\r\n      if (typeof this.duration !== 'number')\r\n        throw new Error('Keyframe with delay has to have duration setted');\r\n      timing =\r\n        this.type === 'ratio'\r\n          ? ratioAndMilisecons(timing, this.delay, this.duration)\r\n          : timing + this.delay!;\r\n    }\r\n    if (typeof this.duration !== 'number')\r\n      throw new Error(\r\n        'Need to set this.duration to each keyframe in the keyframes manager'\r\n      );\r\n    // if (this.type === 'miliseconds' && !this.duration) console.log(this);\r\n    return this.type === 'miliseconds'\r\n      ? timing / (this.duration === 0 ? 1 : this.duration / duration)\r\n      : duration * timing;\r\n  }\r\n}\r\n\r\nexport class valueKeyframe extends _keyframe implements ISimpleKeyframe {\r\n  constructor(\r\n    public value: number,\r\n    timing: number,\r\n    type: 'ratio' | 'miliseconds' = 'miliseconds',\r\n    delay?: number,\r\n    hold: boolean = false\r\n  ) {\r\n    super(timing, type, delay, hold);\r\n  }\r\n}\r\n// unknown now but maybe a special kind of AlgoFrame + Timeline for nested sequencees! And must fit in the timeline keyframe\r\nexport class nestedKeyframe extends _keyframe implements IObjectKeyframe {\r\n  constructor(\r\n    public obj: Sequence,\r\n    timing: number,\r\n    type: 'ratio' | 'miliseconds' = 'miliseconds',\r\n    delay?: number\r\n  ) {\r\n    super(timing, type, delay);\r\n  }\r\n}\r\n\r\n// Enumerables\r\n// export type SimpleKeyframes = BaseKeyframe[];\r\n// export type ComplexKeyframes = ObjectKeyframe[];\r\n\r\nexport function isSimple(object: any): object is ISimpleKeyframe {\r\n  return 'value' in object && object instanceof _keyframe;\r\n}\r\nexport function isComplex(object: any): object is IObjectKeyframe {\r\n  return 'obj' in object && object instanceof _keyframe;\r\n}\r\n\r\n// Anonymous Interfaces\r\nexport type __objectKeyframe = {\r\n  obj: Sequence;\r\n  timing: number;\r\n  type: 'ratio' | 'miliseconds';\r\n  delay?: number;\r\n  duration?: number;\r\n};\r\nexport type __valueKeyframe = {\r\n  value: number;\r\n  timing: number;\r\n  type: 'ratio' | 'miliseconds';\r\n  delay?: number;\r\n  duration?: number;\r\n};\r\n","// @ts-ignore\r\nimport * as AF from './algoframe'; // * AlgoFrame 4.4.4\r\nconst global = {\r\n  delay: 300,\r\n};\r\nimport {\r\n  _keyframe,\r\n  KeyChanger,\r\n  nestedKeyframe,\r\n  Sequence,\r\n  valueKeyframe,\r\n} from './modules/timeline';\r\nimport { ChannelBlock } from './modules/timeline/channels';\r\nconst basic = new Sequence(false, [\r\n  new valueKeyframe(2222, 0, 'ratio'),\r\n  new valueKeyframe(4444, 0.5, 'ratio'),\r\n  new valueKeyframe(6666, 1, 'ratio'),\r\n]);\r\nconst first = new Sequence(false, [\r\n  new nestedKeyframe(basic.clone(), 0, 'ratio'),\r\n  new nestedKeyframe(basic.clone(), 0.5, 'ratio'),\r\n  new nestedKeyframe(basic.clone(), 1, 'ratio'),\r\n]);\r\nconst second = new Sequence(1000, [\r\n  new nestedKeyframe(first.clone(), 0, 'ratio'),\r\n  new nestedKeyframe(first.clone(), 0.5, 'ratio'),\r\n  new nestedKeyframe(first.clone(), 1, 'ratio'),\r\n]);\r\n\r\nfunction animate() {\r\n  let number = 0;\r\n  return function startAnimation(sequence: KeyChanger<any>): void {\r\n    number++;\r\n    const animation = new AF.AlgoFrame(\r\n      sequence.duration,\r\n      global.delay,\r\n      'linear',\r\n      second\r\n    );\r\n    animation.run(\r\n      (b: number, a: number, c: { timestamp: number }) =>\r\n        console.log(b, (a * 100).toFixed(0), c.timestamp - global.delay),\r\n      'Animation ' + number\r\n    );\r\n  };\r\n}\r\nconst start = animate();\r\n// console.log(new ChannelBlock(second, 100).end());\r\nconsole.log(second, second.duration, 'duration');\r\n\r\nconst custom = 3 || 12;\r\nconst getNewK = ({ duration }: { duration: number }) =>\r\n  new valueKeyframe(4444, duration + 1, 'miliseconds', 200);\r\nfor (let i = 0; i < custom; i++) {\r\n  second.addKeyframes(getNewK(second));\r\n}\r\n\r\nsecond.reset();\r\nconsole.log(\r\n  second.duration,\r\n  'duration',\r\n  second.keyframes.map(k => [k.time(1), k.duration])\r\n);\r\nconsole.log(\r\n  second\r\n    .addKeyframes(getNewK({ duration: second.duration + 200 }))\r\n    .keyframes.map(k => [k.time(1), k.duration])\r\n);\r\n// keyframes deep clone\r\n// second.extendToSequence(second.clone());\r\nconsole.log(second.keyframes.map(k => [k.time(1), k.duration]));\r\n// start(second);\r\n\r\nconsole.error('FROM HERE');\r\n\r\nlet copy = second.clone();\r\ncopy.addKeyframes(getNewK({ duration: second.duration + 200 }));\r\nconsole.log(second.keyframes.length, copy.keyframes.length);\r\n","class EasingFunctions {\r\n  // no easing; no acceleration\r\n  static linear: (t: number) => number = t => t;\r\n  // accelerating from zero velocity\r\n  static easeInQuad: (t: number) => number = t => t * t;\r\n  // decelerating to zero velocity\r\n  static easeOutQuad: (t: number) => number = t => t * (2 - t);\r\n  // acceleration until halfway; then deceleration\r\n  static easeInOutQuad: (t: number) => number = t =>\r\n    t < 0.5 ? 2 * t * t : -1 + (4 - 2 * t) * t;\r\n  // accelerating from zero velocity\r\n  static easeInCubic: (t: number) => number = t => t * t * t;\r\n  // decelerating to zero velocity\r\n  static easeOutCubic: (t: number) => number = t => --t * t * t + 1;\r\n  // acceleration until halfway; then deceleration\r\n  static easeInOutCubic: (t: number) => number = t =>\r\n    t < 0.5 ? 4 * t * t * t : (t - 1) * (2 * t - 2) * (2 * t - 2) + 1;\r\n  // accelerating from zero velocity\r\n  static easeInQuart: (t: number) => number = t => t * t * t * t;\r\n  // decelerating to zero velocity\r\n  static easeOutQuart: (t: number) => number = t => 1 - --t * t * t * t;\r\n  // acceleration until halfway; then deceleration\r\n  static easeInOutQuart: (t: number) => number = t =>\r\n    t < 0.5 ? 8 * t * t * t * t : 1 - 8 * --t * t * t * t;\r\n  // accelerating from zero velocity\r\n  static easeInQuint: (t: number) => number = t => t * t * t * t * t;\r\n  // decelerating to zero velocity\r\n  static easeOutQuint: (t: number) => number = t => 1 + --t * t * t * t * t;\r\n  // acceleration until halfway; then deceleration\r\n  static easeInOutQuint: (t: number) => number = t =>\r\n    t < 0.5 ? 16 * t * t * t * t * t : 1 + 16 * --t * t * t * t * t;\r\n}\r\ntype Preset = string | ((x: number) => number);\r\nfunction passPreset(preset: Preset) {\r\n  if (typeof preset !== 'function') {\r\n    return EasingFunctions[\r\n      preset as keyof typeof EasingFunctions\r\n    ] as Preset as (t: number) => number;\r\n  } else {\r\n    return preset as (t: number) => number;\r\n  }\r\n}\r\nexport { EasingFunctions, Preset, passPreset };\r\n","export const EasingFunctions = {\r\n  // no easing, no acceleration\r\n  linear: (t) => t,\r\n  // accelerating from zero velocity\r\n  easeInQuad: (t) => t * t,\r\n  // decelerating to zero velocity\r\n  easeOutQuad: (t) => t * (2 - t),\r\n  // acceleration until halfway, then deceleration\r\n  easeInOutQuad: (t) => (t < 0.5 ? 2 * t * t : -1 + (4 - 2 * t) * t),\r\n  // accelerating from zero velocity\r\n  easeInCubic: (t) => t * t * t,\r\n  // decelerating to zero velocity\r\n  easeOutCubic: (t) => --t * t * t + 1,\r\n  // acceleration until halfway, then deceleration\r\n  easeInOutCubic: (t) =>\r\n    t < 0.5 ? 4 * t * t * t : (t - 1) * (2 * t - 2) * (2 * t - 2) + 1,\r\n  // accelerating from zero velocity\r\n  easeInQuart: (t) => t * t * t * t,\r\n  // decelerating to zero velocity\r\n  easeOutQuart: (t) => 1 - --t * t * t * t,\r\n  // acceleration until halfway, then deceleration\r\n  easeInOutQuart: (t) =>\r\n    t < 0.5 ? 8 * t * t * t * t : 1 - 8 * --t * t * t * t,\r\n  // accelerating from zero velocity\r\n  easeInQuint: (t) => t * t * t * t * t,\r\n  // decelerating to zero velocity\r\n  easeOutQuint: (t) => 1 + --t * t * t * t * t,\r\n  // acceleration until halfway, then deceleration\r\n  easeInOutQuint: (t) =>\r\n    t < 0.5 ? 16 * t * t * t * t * t : 1 + 16 * --t * t * t * t * t,\r\n};\r\n","import { EasingFunctions } from './utils';\r\nclass AlgoFrame {\r\n  constructor(\r\n    duration,\r\n    starttime,\r\n    easing,\r\n    keyframes,\r\n    FPS = null,\r\n    loop = false\r\n  ) {\r\n    if (typeof easing !== 'function') {\r\n      this.easing = EasingFunctions[easing];\r\n    } else {\r\n      this.easing = easing;\r\n    }\r\n    this.starttime = starttime ? starttime : 0;\r\n    this._starttime = this.starttime;\r\n    this.duration = duration;\r\n    this.startafterwait = null;\r\n    this.startanimationtime = null;\r\n    this.stop = false;\r\n    this._start = new Promise(res => (this.__start = res));\r\n    // if (!(keyframes instanceof Keyframes)) {\r\n    //   throw new Error('Invalid Keyframes Object!');\r\n    // }\r\n    this.keyframes = keyframes;\r\n    this.done = false;\r\n    this.next = undefined;\r\n\r\n    this._FPS = FPS;\r\n    this.frameDelay = 1000 / this._FPS;\r\n    this.frameRate = 0;\r\n    this.frame = -1;\r\n    this.animationFrame = -1;\r\n\r\n    this.loop = loop;\r\n  }\r\n  get FPS() {\r\n    return this._FPS ? 1000 / this._FPS : null;\r\n  }\r\n  set FPS(value) {\r\n    const FPS = parseFloat(value);\r\n    if (FPS) {\r\n      this._FPS = FPS;\r\n      this.frameDelay = 1000 / FPS;\r\n      // this.frame = -1;\r\n      // this.starttime = null;\r\n    } else throw new Error('Not a valid Number');\r\n  }\r\n  nextTime(arr = this._running) {\r\n    if (!arr.length) {\r\n      console.log(new Error());\r\n    }\r\n    return arr.reduce((previousValue, currentValue) =>\r\n      currentValue.time < previousValue.time ? currentValue : previousValue\r\n    );\r\n  }\r\n  save(callback, precision) {\r\n    this.callback = callback;\r\n    this.precision = precision;\r\n  }\r\n  restartKeyframes(t) {\r\n    this._timeline.forEach(t => {\r\n      if (t.id === this._current.id) return;\r\n      t._.keyframes.restart();\r\n      t._.keyframes.nextTime();\r\n      t.running = false;\r\n    });\r\n  }\r\n  restartTimeline() {\r\n    this._timeline.forEach(x => this._running.push(x));\r\n    this._next = this.nextTime();\r\n  }\r\n  timeline(array, real, reverseLoop) {\r\n    this._timeline = [];\r\n    this._running = [];\r\n    let data = [];\r\n    array.forEach(event => {\r\n      if (event.time >= 1 || event.time < 0 || isNaN(event.time)) {\r\n        throw new Error('Not valid');\r\n      }\r\n      data.push({\r\n        _: new AlgoFrame(\r\n          event.duration,\r\n          event.delay ? event.delay : 0,\r\n          event.easing ? event.easing : this.easing,\r\n          event.keyframes ? event.keyframes.clone() : this.keyframes.clone(),\r\n          this._FPS\r\n        ).finally(event.finally),\r\n        time: event.time,\r\n        callback: event.run,\r\n      });\r\n    });\r\n    let all = array.reduce((p, c) => {\r\n      return p + c.duration || 0 + c.delay || 0;\r\n    }, 0);\r\n    if (all / array[array.length - 1].time < array[array.length - 1].duration) {\r\n      this.duration +=\r\n        array[array.length - 1].duration - all / array[array.length - 1].time;\r\n    }\r\n    if (this.duration < all) {\r\n      this.duration = all;\r\n    }\r\n    const len = data.length;\r\n    for (let i = 0; i < len; i++) {\r\n      const cur = this.nextTime(data);\r\n      cur.id = i + 1;\r\n      cur._.id = i + 1;\r\n      this._timeline.push(cur);\r\n      data.splice(data.indexOf(this._timeline[i]), 1);\r\n    }\r\n    this.saved_timeline = this._timeline.map(l => l.time);\r\n    this.restartTimeline();\r\n    let first = this._next;\r\n    let last = this._timeline.reduce((previousValue, currentValue) =>\r\n      currentValue.time > previousValue.time ? currentValue : previousValue\r\n    );\r\n    this.reversed = false;\r\n    this.callback = function (X, easedProgress, params) {\r\n      real(X, easedProgress, params);\r\n      const next = () => {\r\n        this._next._.startanimationtime =\r\n          params.timestamp + this._next._._starttime;\r\n        this._next._.waiting = true;\r\n\r\n        //Parent info\r\n        this._next._.time = this._next.time;\r\n\r\n        this._next._.run(this._next.callback);\r\n        this._next.running = true;\r\n        this._current = this._next;\r\n        this._running.shift();\r\n        console.log(\r\n          this._next.time,\r\n          this._running.map(l => l.time)\r\n        );\r\n        if (this._running.length) {\r\n          this._next = this.nextTime();\r\n        }\r\n      };\r\n      if (this._next) {\r\n        if (easedProgress >= this._next.time && !this._next.running) {\r\n          next();\r\n        }\r\n      } else {\r\n        console.log('REVERSED');\r\n        if (reverseLoop && !this.reversed) {\r\n          this._timeline.forEach((l, i) => {\r\n            l.time =\r\n              this.saved_timeline[this.saved_timeline.length - (i + 1)] -\r\n              this.nextTime(this.saved_timeline);\r\n          });\r\n        } else if (reverseLoop) {\r\n          this._timeline.forEach((l, i) => (l.time = this.saved_timeline[i]));\r\n        }\r\n\r\n        while (this._running.length) this._running.shift();\r\n        this.restartTimeline();\r\n        this.restartKeyframes();\r\n        if (reverseLoop && !this.reversed) this._running.reverse();\r\n        this.reversed = !this.reversed;\r\n        first = this._next;\r\n        last = this._timeline.reduce((previousValue, currentValue) =>\r\n          currentValue.time > previousValue.time ? currentValue : previousValue\r\n        );\r\n        this._running.shift();\r\n        this._next = this.nextTime();\r\n        next();\r\n      }\r\n    };\r\n    return this;\r\n  }\r\n  run(callback, precision = this._FPS) {\r\n    let condition, seg;\r\n    this.callback = callback ? callback : this.callback;\r\n\r\n    class Refresher {\r\n      constructor(precision = 1) {\r\n        this.history = new Array(precision).fill(0);\r\n        this.last = 0;\r\n        this.currenttime = 0;\r\n      }\r\n      refresh(timestamp) {\r\n        this.history.unshift(0);\r\n        this.history.pop();\r\n        this.history[0] = timestamp - this.currenttime;\r\n        this.last = this.history.includes(0)\r\n          ? 'Calculating...'\r\n          : this.history.reduce((prev, curr) => prev + curr) /\r\n            this.history.length;\r\n        this.currenttime = timestamp;\r\n      }\r\n    }\r\n\r\n    this.last = new Refresher();\r\n    if (isNaN(precision)) {\r\n      console.log(new Error(`${precision} is NaN`));\r\n      precision = this._FPS;\r\n      if (!isNaN(this.precision)) precision = this.precision;\r\n    }\r\n    this.lastFrameRate = this.lastFrameRate\r\n      ? this.lastFrameRate\r\n      : new Refresher(precision);\r\n\r\n    function animate(timestamp) {\r\n      if (this.done) {\r\n        this.frame = -1;\r\n        this.startanimationtime = timestamp;\r\n        this.done = false;\r\n        this._next = null;\r\n      }\r\n      if (this._FPS) {\r\n        seg = Math.floor((timestamp - this.starttime) / this.frameDelay);\r\n        condition = Boolean(seg > this.frame);\r\n      } else {\r\n        condition = true;\r\n      }\r\n      this.last.refresh(timestamp);\r\n      const runtime = timestamp - this.startanimationtime;\r\n      let relativeProgress = runtime / this.duration;\r\n      const easedProgress = this.easing(relativeProgress);\r\n      this.progress = easedProgress;\r\n      if (!this.startanimationtime && this.starttime === 0) {\r\n        this.startanimationtime = timestamp;\r\n      } else if (this.starttime > 0) {\r\n        this.startanimationtime = timestamp;\r\n        this.starttime =\r\n          this.starttime - this.last.last < this.last.last * 0.7\r\n            ? 0\r\n            : this.starttime - this.last.last;\r\n        requestAnimationFrame(animate.bind(this));\r\n        return;\r\n      }\r\n      let sent = false;\r\n      if (condition) {\r\n        this.frame = seg;\r\n        this.animationFrame++;\r\n        this.lastFrameRate.refresh(timestamp);\r\n        sent = true;\r\n        this.callback(\r\n          this.waiting ? 0 : this.keyframes.test(Math.min(easedProgress, 1)),\r\n          Math.min(easedProgress, 1),\r\n          {\r\n            lastFrame: this.lastFrameRate.last,\r\n            currentTime: this.lastFrameRate.currentTime,\r\n            frame: this.animationFrame,\r\n            timestamp,\r\n          }\r\n        );\r\n        this.waiting = false;\r\n      }\r\n      if (!this.stop) {\r\n        if (runtime < this.duration) {\r\n          requestAnimationFrame(animate.bind(this));\r\n        } else if (runtime + this.last.last > this.duration) {\r\n          this.animationFrame++;\r\n          // this.keyframes.nextTime();\r\n          this.callback(this.keyframes.test(1), 1, {\r\n            lastFrame: this.lastFrameRate.last,\r\n            currentTime: this.lastFrameRate.currenttime,\r\n            frame: this.animationFrame,\r\n            timestamp,\r\n          });\r\n          this.done = true;\r\n          // this.keyframes.restart();\r\n          // debugger;\r\n          if (this.loop) requestAnimationFrame(animate.bind(this));\r\n          this.next?.();\r\n        } else if (!this.done) {\r\n          this.done = true;\r\n          // this.keyframes.restart();\r\n          if (this.loop) requestAnimationFrame(animate.bind(this));\r\n          this.next?.();\r\n        }\r\n      }\r\n      if (this.animationFrame === 0) this.__start();\r\n    }\r\n    requestAnimationFrame(animate.bind(this));\r\n    return this;\r\n  }\r\n  finally(callback) {\r\n    this.next = callback;\r\n    return this;\r\n  }\r\n  break() {\r\n    this.stop = false;\r\n    return this;\r\n  }\r\n  listen(type, callback) {\r\n    switch (type) {\r\n      case 'start':\r\n        this._start.then(callback);\r\n        break;\r\n    }\r\n  }\r\n}\r\nclass Keyframes {\r\n  constructor(keyframes, easing) {\r\n    this.keyframes = [];\r\n    this.run = [];\r\n    keyframes.every((keyframe, i) => {\r\n      if (\r\n        !(keyframe instanceof Keyframes.keyframe) ||\r\n        this.keyframes.some(k => k.time === keyframe.time)\r\n      ) {\r\n        console.error(new Error(`Invalid Keyframe ${i + 1}!`));\r\n        return false;\r\n      } else {\r\n        this.keyframes.push(keyframe);\r\n        return true;\r\n      }\r\n    });\r\n    this.keyframes.forEach(k => this.run.push(k));\r\n    if (typeof easing !== 'function') {\r\n      this.easing = EasingFunctions[easing];\r\n    } else {\r\n      this.easing = easing;\r\n    }\r\n    this.nextTime();\r\n  }\r\n  nextTime() {\r\n    if (!this.run.length) {\r\n      return (this.next = null);\r\n    }\r\n\r\n    if (this.run.length > 1) {\r\n      this.current = this.run.reduce((previousValue, currentValue) =>\r\n        currentValue.time < previousValue.time ? currentValue : previousValue\r\n      );\r\n      this.next = this.run\r\n        .filter(v => v.time !== this.current.time)\r\n        .reduce((previousValue, currentValue) =>\r\n          currentValue.time < previousValue ? currentValue : previousValue\r\n        );\r\n    } else {\r\n      this.restart();\r\n      this.next = this.run.reduce((previousValue, currentValue) =>\r\n        currentValue.time < previousValue.time ? currentValue : previousValue\r\n      );\r\n    }\r\n    this.run.shift();\r\n  }\r\n  restart() {\r\n    while (this.run.length) this.run.pop();\r\n    this.keyframes.forEach(k => this.run.push(k));\r\n  }\r\n  test(progress) {\r\n    if (this.next.time <= progress) this.nextTime();\r\n    progress = Math.min(this.easing(progress), 1);\r\n    const dif = this.next.val - this.current.val;\r\n    const a = this.next.time - this.current.time;\r\n    const sum = dif * progress;\r\n    return (this.current.val + sum) / a;\r\n  }\r\n  clone() {\r\n    let orig = this;\r\n    return Object.assign(Object.create(Object.getPrototypeOf(orig)), orig);\r\n  }\r\n  static keyframe = class {\r\n    constructor(totalProgress, value) {\r\n      this.time = totalProgress;\r\n      this.val = value;\r\n    }\r\n  };\r\n}\r\n\r\n// const anim = new AlgoFrame(2500, 2000, \"easeInQuad\", 50, 150);\r\n// anim.run((x) => console.log(x));\r\n\r\nexport { AlgoFrame, Keyframes };\r\n","// The module cache\nvar __webpack_module_cache__ = {};\n\n// The require function\nfunction __webpack_require__(moduleId) {\n\t// Check if module is in cache\n\tvar cachedModule = __webpack_module_cache__[moduleId];\n\tif (cachedModule !== undefined) {\n\t\treturn cachedModule.exports;\n\t}\n\t// Create a new module (and put it into the cache)\n\tvar module = __webpack_module_cache__[moduleId] = {\n\t\t// no module.id needed\n\t\t// no module.loaded needed\n\t\texports: {}\n\t};\n\n\t// Execute the module function\n\t__webpack_modules__[moduleId].call(module.exports, module, module.exports, __webpack_require__);\n\n\t// Return the exports of the module\n\treturn module.exports;\n}\n\n","// define getter functions for harmony exports\n__webpack_require__.d = (exports, definition) => {\n\tfor(var key in definition) {\n\t\tif(__webpack_require__.o(definition, key) && !__webpack_require__.o(exports, key)) {\n\t\t\tObject.defineProperty(exports, key, { enumerable: true, get: definition[key] });\n\t\t}\n\t}\n};","__webpack_require__.o = (obj, prop) => (Object.prototype.hasOwnProperty.call(obj, prop))","// define __esModule on exports\n__webpack_require__.r = (exports) => {\n\tif(typeof Symbol !== 'undefined' && Symbol.toStringTag) {\n\t\tObject.defineProperty(exports, Symbol.toStringTag, { value: 'Module' });\n\t}\n\tObject.defineProperty(exports, '__esModule', { value: true });\n};","// startup\n// Load entry module and return exports\n// This entry module is referenced by other modules so it can't be inlined\nvar __webpack_exports__ = __webpack_require__(503);\n"],"names":["root","factory","exports","module","define","amd","self","KeyChanger","constructor","duration","easing","keyframes","next","current","adaptative","this","Math","floor","_","run","passPreset","init","nextTime","length","reduce","previousValue","currentValue","time","filter","v","reset","shift","currentAsSequence","object","progress","end","rProgress","res","obj","test","undefined","static","x","y","a","miliseconds","runAdaptative","nextValue","Error","isSimple","min","kProgress","lerp","value","hold","isComplex","nextValueFromObj","valueKeyframe","getAbsoluteStartValue","sequence","last","nestedKeyframe","getAbsoluteEndKeyframe","Sequence","callback","super","type","taken","window","forEach","k","timing","zero","final","first","unshift","push","i","includes","is_value","addKeyframes","keyframe","nkeyframe","passKeyframe","max","timeIntervals","extendToSequence","seq","console","log","map","clone","copy","replicate","ratioAndMilisecons","ratio","blocks","block","kDuration","tstart","start","delay","Object","assign","create","getPrototypeOf","_keyframe","RangeError","id","instances","basic","second","getNewK","error","EasingFunctions","linear","t","easeInQuad","easeOutQuad","easeInOutQuad","easeInCubic","easeOutCubic","easeInOutCubic","easeInQuart","easeOutQuart","easeInOutQuart","easeInQuint","easeOutQuint","easeInOutQuint","preset","AlgoFrame","starttime","FPS","loop","_starttime","startafterwait","startanimationtime","stop","_start","Promise","__start","done","_FPS","frameDelay","frameRate","frame","animationFrame","parseFloat","arr","_running","save","precision","restartKeyframes","_timeline","_current","restart","running","restartTimeline","_next","timeline","array","real","reverseLoop","data","event","isNaN","finally","all","p","c","len","cur","splice","indexOf","saved_timeline","l","reversed","X","easedProgress","params","timestamp","waiting","reverse","condition","seg","Refresher","history","Array","fill","currenttime","refresh","pop","prev","curr","lastFrameRate","requestAnimationFrame","animate","Boolean","runtime","relativeProgress","bind","sent","lastFrame","currentTime","break","listen","then","Keyframes","every","some","dif","val","sum","totalProgress","__webpack_module_cache__","__webpack_require__","moduleId","cachedModule","__webpack_modules__","call","d","definition","key","o","defineProperty","enumerable","get","prop","prototype","hasOwnProperty","r","Symbol","toStringTag"],"sourceRoot":""}