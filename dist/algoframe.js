!function(t,i){"object"==typeof exports&&"object"==typeof module?module.exports=i():"function"==typeof define&&define.amd?define([],i):"object"==typeof exports?exports.AlgoFrame=i():t.AlgoFrame=i()}(self,(()=>(()=>{"use strict";var t={d:(i,e)=>{for(var s in e)t.o(e,s)&&!t.o(i,s)&&Object.defineProperty(i,s,{enumerable:!0,get:e[s]})},o:(t,i)=>Object.prototype.hasOwnProperty.call(t,i),r:t=>{"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(t,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(t,"__esModule",{value:!0})}},i={};t.r(i),t.d(i,{default:()=>n});const e={linear:t=>t,easeInQuad:t=>t*t,easeOutQuad:t=>t*(2-t),easeInOutQuad:t=>t<.5?2*t*t:(4-2*t)*t-1,easeInCubic:t=>t*t*t,easeOutCubic:t=>--t*t*t+1,easeInOutCubic:t=>t<.5?4*t*t*t:(t-1)*(2*t-2)*(2*t-2)+1,easeInQuart:t=>t*t*t*t,easeOutQuart:t=>1- --t*t*t*t,easeInOutQuart:t=>t<.5?8*t*t*t*t:1-8*--t*t*t*t,easeInQuint:t=>t*t*t*t*t,easeOutQuint:t=>1+--t*t*t*t*t,easeInOutQuint:t=>t<.5?16*t*t*t*t*t:1+16*--t*t*t*t*t};class s{constructor(t,i,s,n,a,r=null,h=!1){this.easing="function"!=typeof s?e[s]:s,this.starttime=i,this._starttime=i,this.duration=t,this.startafterwait=null,this.startanimationtime=null,this.stop=!1,this._start=new Promise((t=>this.__start=t)),this.startX=n,this.endX=a,this.done=!1,this.next=void 0,this._FPS=r,this.frameDelay=1e3/this._FPS,this.frameRate=0,this.frame=-1,this.animationFrame=-1,this.loop=h}get FPS(){return this._FPS?1e3/this._FPS:null}set FPS(t){const i=parseFloat(t);if(!i)throw new Error("Not a valid Number");this._FPS=i,this.frameDelay=1e3/i}nextTime(){this._running.length||(this._next=null,this.timelineEnd=!0),this.timelineEnd||(this._next=this._running.reduce(((t,i)=>i<t?i:t)))}timeline(t,i){return this._timeline=[],this._running=[],this.timelineEnd=!1,t.forEach((t=>{this._timeline.push({_:new s(t.duration,t.delay?t.delay:0,t.easing?t.easing:this.easing,t.startX?t.startX:this.startX,t.endX?t.endX:this.endX,this._FPS).finally(t.finally),time:t.time,callback:t.run})})),this._timeline.forEach((t=>this._running.push(t))),this.nextTime(),this.callback=function(t,e,s){i(t,e,s),this._next&&e>=this._next.time&&(this._next._.startanimationtime=s.timestamp+this._next._._starttime,console.log(this._next._.starttime,s.timestamp),this._next._.run(this._next.callback),this._running.shift(),this.nextTime())},this}run(t,i=this._FPS){let e,s,n;this.callback=t||this.callback,this.timelineEnd=!1;class a{constructor(t=1){this.history=new Array(t).fill(0),this.last=0,this.currenttime=0}refresh(t){this.history.unshift(0),this.history.pop(),this.history[0]=t-this.currenttime,this.last=this.history.includes(0)?"Calculating...":this.history.reduce(((t,i)=>t+i))/this.history.length,this.currenttime=t}}const r=new a;isNaN(i)&&(console.log(new Error(`${i} is NaN`)),i=this._FPS);const h=new a(i);return requestAnimationFrame(function a(o){this.done&&(this.frame=-1,this.starttime=this._starttime,this._timeline&&(this._timeline.forEach((t=>this._running.push(t))),this.nextTime()),this.done=!1),this._FPS?(n=Math.floor((o-this.starttime)/this.frameDelay),s=Boolean(n>this.frame)):s=!0,r.refresh(o);const m=o-this.startanimationtime;let l=m/this.duration;l>1&&(l=1);const u=this.easing(l);if(this.startanimationtime||0!==this.starttime){if(this.starttime>0)return this.startanimationtime=o,this.starttime=this.starttime-r.last<.7*r.last?0:this.starttime-r.last,void requestAnimationFrame(a.bind(this))}else this.starttimeBefore=o,this.startanimationtime=o;let c=!1;s&&(this.frame=n,this.animationFrame++,h.refresh(o),c=!0,e=(this.endX-this.startX)*Math.min(u,1),this.callback(e+this.startX,u,{lastFrame:h.last,currentTime:h.currentTime,frame:this.animationFrame,timestamp:o})),this.stop||(m<this.duration?requestAnimationFrame(a.bind(this)):m-.9*r.last<this.duration&&!c?(this.animationFrame++,this.callback(this.endX,1,{lastFrame:h.last,currentTime:h.currenttime,frame:this.animationFrame,timestamp:o}),this.done=!this.done,this.loop&&this.run(t,i),this.next?.()):(this.done=!this.done,this.loop&&this.run(t,i),this.next?.())),0===this.animationFrame&&this.__start()}.bind(this)),this}finally(t){return this.next=t,this}break(){return this.stop=!1,this}listen(t,i){"start"===t&&this._start.then(i)}}const n=s;return i})()));